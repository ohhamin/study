# key

key : 검색, 정렬 시 튜플을 구분할 수 있는 기준이 되는 속성

##### 1. 후보키

기본키로 사용할 수 있는 속성들

1. 유일성 : key로 하나의 Tuple을 유일하게 식별할 수 있음

2. 최소성 : 꼭 필요한 속성으로만 구성

##### 2. 기본키

후보키 중 선택한 Main key

Null값을 가질 수 없음, 동일한 값이 중복될 수 없음

##### 3. 대체키(보조키)

후보키 중 기본키를 제외한 나머지 키

##### 4. 슈퍼키

유일성은 만족하지만 최소성은 만족하지 못하는 키

##### 5. 외래키

다른 릴레이션의 기본키를 그대로 참조하는 속성의 집합

---

# SQL

### 1. SQL, NOSQL

##### SQL (관계형 DB)

SQL을 사용하면 RDBMS에서 데이터를 저장, 수정, 삭제, 검색이 가능

###### 특징

1. 데이터는 정해진 데이터 스키마에 따라 테이블에 저장된다.

2. 데이터는 관계를 통해 여러 테이블에 분산된다.

3. 일반적으로 수직적(서버의 성능 향상) 향상만 가능

###### 장점

1. 명확하게 정의된 스키마, 데이터의 무결성 보장

2. 관계는 각 데이터를 중복없이 한번만 저장

###### 단점

1. 덜 유연함. 데이터 스키마를 사전에 계획하고 알려야 함.

2. 관계를 맺고 있어서 조인문이 많은 복잡한 쿼리가 만들어질 수 있음

3. 대체로 수직적 확장만 가능

###### 사용

1. 관계를 맺고 있는 데이터가 자주 변경되는 애플리케이션의 경우

2. 변경될 여지가 없고, 명확한 스키마가 사용자와 데이터에게 중요한 경우

##### NOSQL (비관계형 DB)

스키마도 없고, 관계도 없다.

레코드를 문서(document)라 부른다.

###### 특징

1. 문서는 JSON과 비슷한 형태로 가지고 있다. 

2. 수평적(데이터베이스 분산) 확장 가능

3. 관련 데이터를 동일한 컬렉션에 넣는다.

4. 따라서 여러 테이블에 조인할 필요 없이 이미 필요한 모든 것을 갖춘 문서를 작성하는것이 NOSQL이다.

-> 조인을 잘 사용하지 않고, 자주 변경되지 않는 데이터일 때 NOSQL을 쓰면 효율적

###### 장점

1. 스키마가 없어서 유연함. 언제든지 저장된 데이터를 조정하고 새로운 필드 추가 가능

2. 데이터는어플리케이션이 필요로 하는 형식으로 저장되고, 데이터 읽어오는 속도 빨라짐

3. 수직, 수평 확장이 가능해서 애플리케이션이 발생시키는 모든 읽기/쓰기 요청 처리 가능

###### 단점

1. 유연성으로 인해 데이터 구조 결정을 미루게 될 수 있음

2. 데이터 중복을 계속 업데이트 해야 함

3. 데이터가 여러 컬렉션에 중복되어 있기 때문에 수정 시 모든 컬렉션에서 수행해야 함 (SQL에선 중복 데이터가 없기 때문에 한번만 수행)

###### 사용

1. 정확한 데이터 구조를 알 수 없거나 변경/확장 될 수 있는 경우

2. 읽기를 자주 하지만, 데이터 변경은 자주 없는 경우

3. 데이터베이스를 수평으로 확장해야 하는 경우 (빅데이터를 다뤄야 하는 경우)

### 2. JOIN

두 개 이상의 테이블이나 데이터베이스를 연결하여 데이터를 검색하는 방법

###### 종류

1. INNER JOIN
   ![](데이터베이스_assets/2023-01-13-18-36-12-image.png)

    교집합으로, 기준 테이블과 join테이블의 중복된 값을 보여준다

```sql
 SELECT <열 목록>
 FROM <첫 번째 테이블>
          INNER JOIN <두 번째 테이블>
          ON <조인될 조건>
 [WHERE 검색 조건]
```

2. OUTER JOIN
   ![](데이터베이스_assets/2023-01-13-18-44-00-image.png)
   
   - **LEFT** OUTER JOIN: 왼쪽 테이블의 모든 값이 출력되는 조인
   
   - **RIGHT** OUTER JOIN: 오른쪽 테이블의 모든 값이 출력되는 조인
   
   - **FULL** OUTER JOIN: 왼쪽 또는 오른쪽 테이블의 모든 값이 출력되는 조인

```sql
 SELECT <열 목록>
 FROM <첫 번째 테이블(LEFT 테이블)>
          <LEFT | RIGHT | FULL> OUTER JOIN <두 번째 테이블(RIGHT 테이블)>
           ON <조인될 조건>
 [WHERE 검색 조건]
```

3. CROSS JOIN
   ![](데이터베이스_assets/2023-01-13-18-45-09-image.png)
   모든 경우의 수를 전부 표현해주는 방식

```sql
 SELECT * 
 FROM <첫 번째 테이블>
           CROSS JOIN <두 번째 테이블>
```

4. SELF JOIN
   ![](데이터베이스_assets/2023-01-13-18-45-54-image.png)

    하나의 테이블을 여러번 복사해서 조인한다. (별칭을 사용함)
    자신이 갖고 있는 칼럼을 다양하게 변형시켜 활용할 때 자주 사용

```sql
 SELECT <열 목록>
 FROM <테이블> 별칭A
          INNER JOIN <테이블> 별칭B
          ON <조인될 조건>
 [WHERE 검색 조건]
```

### 3. SQL Injection

해커에 의해 조작된 SQL 쿼리문이 데이터베이스에 전달되어 비정상적 명령을 실행시키는 공격 기법

##### 공격방법

1. 인증우회
   input창에 비밀번호를 입력함과 동시에 다른 쿼리문을 함께 입력해 데이터베이스에 영향을 줌
   기본 쿼리문의 WHERE절 뒤에 OR문 추가하여 '1' = '1' 같은 true 문을 작성하여 무조건 적용되게 한 후 데이터베이스 조작

2. 데이터노출
   에러를 발생시키고 에러 메세지를 통해 데이터베이스 구조를 유추한 후 해킹

##### 방어방법

1. input 값을 받을 때 특수문자 여부 검사하기

2. SQL 서버 오류 시 에러메세지 감추기 (view를 활용하여 권한을 높임)

3. preparestatement 사용하기 (특수문자를 자동 escaping해줌)




